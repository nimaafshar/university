# گزارش پروژه‌ی سیستم عامل

## بخش اول: سرور و کلاینت حافظه‌ی اشتراکی
ما در این بخش دو حافظهی اشتراکی‌
a
و
b
داریم حافظه‌ی اشتراکی
a 
و
b 
هرکدام شامل یک آرایه از رشته‌هایی به اندازه‌ی
size_buffer
هستند. و هر آرایه تعداد مشخصی از این رشته‌ها یا همان
BLOCK
ها دارد. حافظهی اشتراکی
a
همچین یک آرایه برای مشخص کردن وضعیت بلاک‌ها و همچنین یک متغیر برای مشخص بودن آماده‌بودن سرور دارد.
(کلاینت قبل از آماده بودن سرور چیزی روی حافظه‌ی اشتراکی
a
نمینویسد).
ابتدا سرور وضعیت همه‌ی بلاک‌ها را به حالت
۲ (آزاد)
تغییر میدهد. سرور و همه‌ی کلاینت‌ها از یک سمافور مشترک از نوع
V System
برای دسترسی به حافظه اشتراکی 
a
استفاده میکنند ولی چون کلاینت‌ها تنها از حافظهی اشتراکی
b
میخوانند و تنها سرور در حافظه‌ی اشتراکی 
b
مینویسد، برای آن سمافوری در نظر گرفته نشده است. 
هر کلاینت ابتدا در یک لوپ منتظر میماند تا سرور به حالت آماده در بیاید.
سپس سمافور را میگیرد و در اولین بلاک آزاد متن خود را مینویسد.
سپس وضعیت این بلاک را به حالت ۰ (منتظر پردازش) عوض میکند. پس از آن سمافور را آزاد میکند و منتظر میماند تا وقتی که سرور سمافور را بگیرد و همه‌ی بلاکهای منتظر پردازش را پردازش کند و جوابهایشان را در
b
قرار دهد. پس از قرار دادن جواب هر بلاک در b وضعیت آن را در آرایه به ۱ (منتظر خوانده شدن جواب) تغییر میدهد.
سپس کلاینت جواب را از 
b
میخواند و با گرفتن سمافور دوباره وضعیت آن بلاک را در 
a
به حالت (۲) آزاد در می‌آورد.

همچین سرور هرگاه 
n
چرخه بیکار بماند خود را خاموش می‌کند. همچنین کلاینت فاصله بین نوشتن متن و خواندن جواب را اندازه
میگیرد تا از آن اختلاف زمان کلاینت و سرور را اندازه بگیریم.

## بخش دوم: ارزیابی کارایی
میتوانید کامندهای ارزیابی کارایی و جوابهایی که گرفتهاند را در در دو فایل
evaluation_memory_shared
و
evaluation_TCP
مشاهده کنید.
میتوان دید که با افزایش حجم داده از ١٠٠ بایت به ٨ کیلوبایت زمان انتقال دهندهی 
TCP
از ۴ میلی ثانیه به ١۴ میلی ثانیه افزایش می‌یابد ولی زمان انتقال دهنده با حافظه‌ی اشتراکی تغییر چندانی نمی‌کند که قابل انتظار بود.
البته در مورد حافظهی اشتراکی
time_sleep
یک چرخه حتما به زمان اضافه میشود که در این مورد من 
time_sleep
را ١ ثانیه در نظر گرفتم ولی اگر 
time_sleep
هر چرخه را کاهش دهیم زمان کلی انتقال حافظه‌ی اشتراکی میتواند به چند میلی ثانیه برسد. (چون غیر از زمان چرخه بقیه‌ی اعمال کمتر از ١ میلی ثانیه زمان گرفته‌اند).
